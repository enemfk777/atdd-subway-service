# 인수 테스트 기반 TDD
## 4단계 - 요금 조회

### 요구사항
- [x] 경로 조회 시 거리 기준 요금 정보 포함하기
- [x] 노선별 추가 요금 정책 추가
- [x] 연령별 할인 정책 추가

### 요구사항 설명

---
#### 거리별 요금정책
* 기본운임(10㎞ 이내) : 기본운임 1,250원
* 이용 거리초과 시 추가운임 부과
    * 10km 초과 ∼ 50km 까지(5km 마다 100원)
    * 50km 초과 시 (8km 마다 100원)
#### 수정된 인수 조건
```shell
Feature: 지하철 경로 검색

  Scenario: 두 역의 최단 거리 경로를 조회
    Given: 지하철역이 등록되어있음
    And: 지하철 노선이 등록되어있음
    And: 지하철 노선에 지하철역이 등록되어있음
    When: 출발역에서 도착역까지의 최단 거리 경로 조회를 요청
    Then: 최단 거리 경로를 응답
    And: 총 거리도 함께 응답함
    And: ** 지하철 이용 요금도 함께 응답함 **
```

#### 노선별 추가 요금 정책
* 노선에 `추가 요금` 필드를 추가
* 추가 요금이 있는 노선을 이용 할 경우 측정된 요금에 추가
    * ex) 900원 추가 요금이 있는 노선 8km 이용 시 1,250원 -> 2,150원
    * ex) 900원 추가 요금이 있는 노선 12km 이용 시 1,350원 -> 2,250원
* 경로 중 추가요금이 있는 노선을 환승 하여 이용 할 경우 가장 높은 금액의 추가 요금만 적용
    * ex) 0원, 500원, 900원의 추가 요금이 있는 노선들을 경유하여 8km 이용 시 1,250원 -> 2,150원
    
#### 로그인 사용자의 경우 연령별 요금 할인 적용
* 청소년: 운임에서 350원을 공제한 금액의 20%할인
* 어린이: 운임에서 350원을 공제한 금액의 50%할인
```shell
- 청소년: 13세 이상~19세 미만
- 어린이: 6세 이상~ 13세 미만
```



#### 이전 코드리뷰 반영
- [x] PathService에서 SectionRepository와 StationRepository를 모두 갖는 대신 LineRepository만 갖게 변경
- [x] PathFinder에서 Vertex를 Station Id 대신 Station 객체로 갖게 변경 


#### 코드리뷰 반영
- [x] Fee -> Amount로 클래스 명 변경, Fee는 domain 클래스로 보기는 힘드므로 vo라는 패키지 분리
- [x] AgeDiscount에서 CalculatedFee의 구현체에 대해 강한 의존을 만들어내던 부분 수정
